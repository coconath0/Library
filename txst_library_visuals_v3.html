<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TXST Library — Descriptive, Predictive &amp; Prescriptive Analysis</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=DM+Sans:wght@300;400;500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --gold-light: #c9a84c;
      --gold: #8b6914;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #f5f5f0;
      color: #333;
      overflow-x: hidden;
      width: 100%;
    }

    .header {
      text-align: center;
      background: #501214;
      color: #fff;
      padding: 28px 40px;
      width: 100%;
    }

    .header h1 {
      font-family: 'Playfair Display', serif;
      font-size: 2.5em;
      font-weight: 600;
      word-wrap: break-word;
    }

    .header p {
      font-size: 0.95em;
      color: #d4a843;
      margin-top: 4px;
      word-wrap: break-word;
    }

    /* BUTTON TO OTHER VISUALS */
    .view-more-btn {
      display: inline-block;
      margin-top: 1rem;
      padding: 0.7rem 1.5rem;
      background: var(--gold);
      color: white;
      text-decoration: none;
      border-radius: 8px;
      font-weight: 600;
      font-size: 0.6rem;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      transition: all 0.3s ease;
      position: relative;
      border: 2px solid var(--gold-light);
    }

    .view-more-btn:hover {
      background: var(--gold-light);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(139, 105, 20, 0.3);
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 24px 20px;
      width: 100%;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
      width: 100%;
    }

    .card {
      background: #fff;
      border-radius: 8px;
      padding: 20px 24px;
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08);
      width: 100%;
      min-width: 0;
      overflow: hidden;
    }

    .card.full {
      grid-column: 1 / -1;
    }

    .card h2 {
      font-family: 'Playfair Display', serif;
      font-weight: 800;
      font-size: 1.05em;
      color: #501214;
      margin-bottom: 12px;
      border-bottom: 2px solid #d4a843;
      padding-bottom: 6px;
    }

    .chart-wrap {
      position: relative;
      height: 320px;
    }

    .card.full .chart-wrap {
      height: 360px;
    }

    .stat-row {
      display: flex;
      gap: 16px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      width: 100%;
    }

    .stat-box {
      flex: 1;
      min-width: 140px;
      max-width: 100%;
      background: #faf8f4;
      border-left: 4px solid #d4a843;
      padding: 14px 16px;
      border-radius: 0 6px 6px 0;
      overflow: hidden;
    }

    .stat-box .label {
      font-size: 0.78em;
      color: #777;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .stat-box .value {
      font-size: 1.5em;
      font-weight: 700;
      color: #501214;
      margin-top: 2px;
    }

    .stat-box .sub {
      font-size: 0.8em;
      color: #888;
    }

    .note {
      font-size: 0.82em;
      color: #888;
      margin-top: 8px;
      line-height: 1.5;
    }

    .insight {
      background: #fef9e7;
      border-left: 4px solid #d4a843;
      padding: 10px 14px;
      margin-top: 12px;
      font-size: 0.88em;
      border-radius: 0 6px 6px 0;
    }

    .insight strong {
      color: #501214;
    }

    .section-label {
      font-size: 0.72em;
      text-transform: uppercase;
      letter-spacing: 1.5px;
      color: #fff;
      background: #501214;
      display: inline-block;
      padding: 4px 12px;
      border-radius: 3px;
      margin-bottom: 14px;
    }

    .section-label.predictive {
      background: #1a8a7d;
    }

    .section-label.prescriptive {
      background: #2d5f2d;
    }

    .section-divider {
      margin: 32px 0 20px;
      text-align: center;
    }

    .legend-row {
      display: flex;
      gap: 18px;
      justify-content: center;
      margin-bottom: 14px;
      flex-wrap: wrap;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.85em;
    }

    .legend-dot {
      width: 14px;
      height: 14px;
      border-radius: 3px;
      display: inline-block;
    }

    /* TABLET RESPONSIVE (iPad, etc.) */
    @media (max-width: 1024px) {
      .container {
        padding: 20px 16px;
      }

      .header {
        padding: 24px 20px;
      }

      .header h1 {
        font-size: 1.4em;
      }

      .header p {
        font-size: 0.88em;
      }

      .stat-box {
        min-width: 130px;
      }

      .stat-box .value {
        font-size: 1.35em;
      }

      .chart-wrap {
        height: 280px;
      }

      .card.full .chart-wrap {
        height: 320px;
      }
    }

    /* MOBILE RESPONSIVE (phones) */
    @media (max-width: 768px) {
      body {
        overflow-x: hidden;
      }

      .header {
        padding: 20px 16px;
        width: 100%;
      }

      .header h1 {
        font-size: 1.2em;
        line-height: 1.3;
      }

      .header p {
        font-size: 0.82em;
        line-height: 1.4;
      }

      .container {
        padding: 16px 12px;
        width: 100%;
        max-width: 100vw;
      }

      /* Stack grid to single column */
      .grid {
        grid-template-columns: 1fr;
        gap: 16px;
        width: 100%;
      }

      .card.full {
        grid-column: 1;
      }

      /* Stack stat boxes */
      .stat-row {
        flex-direction: column;
        gap: 12px;
        width: 100%;
      }

      .stat-box {
        min-width: 100%;
        max-width: 100%;
        padding: 12px 14px;
        width: 100%;
      }

      .stat-box .label {
        font-size: 0.75em;
      }

      .stat-box .value {
        font-size: 1.4em;
      }

      .stat-box .sub {
        font-size: 0.78em;
      }

      /* Adjust card padding */
      .card {
        padding: 16px 18px;
        width: 100%;
        max-width: 100%;
      }

      .card h2 {
        font-size: 0.98em;
        margin-bottom: 10px;
        word-wrap: break-word;
      }

      /* Chart heights for mobile */
      .chart-wrap {
        height: 240px;
        width: 100%;
        position: relative;
      }

      .card.full .chart-wrap {
        height: 280px;
      }

      /* Better legend spacing */
      .legend-row {
        gap: 12px;
        font-size: 0.8em;
        flex-wrap: wrap;
        justify-content: center;
      }

      .legend-item {
        font-size: 0.8em;
      }

      .legend-dot {
        width: 12px;
        height: 12px;
      }

      /* Insights and notes */
      .insight {
        font-size: 0.84em;
        padding: 9px 12px;
        word-wrap: break-word;
      }

      .note {
        font-size: 0.8em;
        word-wrap: break-word;
      }

      /* Section labels */
      .section-label {
        font-size: 0.68em;
        padding: 3px 10px;
      }

      .section-divider {
        margin: 24px 0 16px;
      }
    }

    /* SMALL MOBILE (iPhone SE, etc.) */
    @media (max-width: 480px) {
      body {
        width: 100%;
        overflow-x: hidden;
      }

      .header h1 {
        font-size: 1.1em;
      }

      .header p {
        font-size: 0.78em;
        line-height: 1.4;
      }

      .container {
        padding: 12px 10px;
        width: 100%;
        max-width: 100vw;
      }

      .card {
        padding: 14px 16px;
        width: 100%;
        max-width: 100%;
      }

      .card h2 {
        font-size: 0.92em;
      }

      .stat-box .value {
        font-size: 1.3em;
      }

      .chart-wrap {
        height: 220px;
        width: 100%;
      }

      .card.full .chart-wrap {
        height: 260px;
      }

      .insight {
        font-size: 0.82em;
      }

      .legend-item {
        font-size: 0.75em;
      }
    }

    /* LANDSCAPE MOBILE */
    @media (max-width: 896px) and (orientation: landscape) {
      .header {
        padding: 16px 20px;
      }

      .chart-wrap {
        height: 200px;
      }

      .card.full .chart-wrap {
        height: 240px;
      }
    }
  </style>
</head>

<body>

  <div class="header">
    <h1>TXST Library Circulation & Student Enrollment</h1>
    <p>2026 Open Datathon — Bobcat Data Challenge | FY2014–FY2024 + Forecast</p>

    <a href="index.html" class="view-more-btn">View More Interactive Graphs</a>

  </div>

  <div class="container">

    <!-- UPDATED KPI ROW -->
    <div class="stat-row">
      <div class="stat-box">
        <div class="label">FY2024 Circulation</div>
        <div class="value">64,090</div>
        <div class="sub">+5.5% from FY2023</div>
      </div>
      <div class="stat-box">
        <div class="label">Fall 2024 Enrollment</div>
        <div class="value">42,138</div>
        <div class="sub">+1.1% from 2023</div>
      </div>
      <div class="stat-box">
        <div class="label">Per-Student Usage</div>
        <div class="value">1.52</div>
        <div class="sub">Down from 2.04 in FY2020</div>
      </div>
      <div class="stat-box">
        <div class="label">10-Year Circ Decline</div>
        <div class="value">−63%</div>
        <div class="sub">173K (FY15) → 64K (FY24)</div>
      </div>
      <div class="stat-box">
        <div class="label">Forecast FY2025</div>
        <div class="value">~63,624</div>
        <div class="sub">Linear trend (FY21–24)</div>
      </div>
    </div>

    <!-- DESCRIPTIVE SECTION -->
    <div class="section-divider"><span class="section-label">Descriptive</span></div>

    <div class="grid">

      <div class="card full">
        <h2>Annual Library Circulation (FY2014–FY2024)</h2>
        <div class="chart-wrap"><canvas id="chart1"></canvas></div>
        <div class="insight"><strong>Key finding:</strong> Circulation declined 63% over the decade. The decline began
          well before COVID (−35% from FY2015 to FY2019), then COVID accelerated it. Post-COVID recovery has stabilized
          around 60–64K.</div>
      </div>

      <!-- UPGRADED: Dual-Axis LINE chart showing the "jaws" divergence -->
      <div class="card full">
        <h2>The Engagement Gap: Enrollment Up, Circulation Down</h2>
        <div class="chart-wrap"><canvas id="chartDivergence"></canvas></div>
        <div class="insight"><strong>Key finding:</strong> While enrollment held steady (~42K), circulation per student
          dropped from 2.04 to 1.52 — a 25% decline in per-capita library usage in just 4 years, suggesting a behavioral
          shift in how students access resources.</div>
      </div>

      <div class="card">
        <h2>Circulation by Material Type (FY2020–2024)</h2>
        <div class="chart-wrap"><canvas id="chart3"></canvas></div>
        <div class="note">Print/Media includes books, periodicals, and AV. Equipment/Keys includes cameras, projectors,
          calculators, etc.</div>
      </div>

      <div class="card">
        <h2>Equipment & Laptops vs. Print (FY2020–2024)</h2>
        <div class="chart-wrap"><canvas id="chart4"></canvas></div>
        <div class="insight"><strong>Key finding:</strong> Equipment checkouts surged 75% in FY2024, while print fell.
          Non-traditional items now make up 28% of all checkouts, up from 20% in FY2020.</div>
      </div>

      <div class="card">
        <h2>Borrowing by Patron Group — FY2024</h2>
        <div class="chart-wrap"><canvas id="chart5"></canvas></div>
      </div>

      <div class="card">
        <h2>Undergraduate vs. Graduate Checkouts</h2>
        <div class="chart-wrap"><canvas id="chart6"></canvas></div>
        <div class="insight"><strong>Key finding:</strong> Undergraduate checkouts rebounded 17% from FY2023 to FY2024,
          while graduate borrowing continued to decline — possibly reflecting greater digital resource use among grad
          students.</div>
      </div>

      <div class="card full">
        <h2>Top Library Locations by Circulation (FY2024)</h2>
        <div class="chart-wrap"><canvas id="chart7"></canvas></div>
      </div>

    </div>

    <!-- PREDICTIVE SECTION -->
    <div class="section-divider"><span class="section-label predictive">Predictive</span></div>

    <div class="grid">
      <div class="card full">
        <h2>Circulation Forecast: Stabilizing Around 60–65K Baseline</h2>
        <div class="chart-wrap"><canvas id="chartForecast"></canvas></div>
        <div class="insight"><strong>Model:</strong> A linear fit on FY2021–FY2024 data (slope ≈ +370 transactions/year)
          projects FY2025 at ~63,624 and FY2026 at ~63,994. The decade-long freefall has ended; circulation is
          stabilizing at a new, lower baseline — freeing resources for reallocation.</div>
      </div>
    </div>

    <!-- PRESCRIPTIVE SECTION -->
    <div class="section-divider"><span class="section-label prescriptive">Prescriptive</span></div>

    <div class="grid">
      <div class="card full">
        <h2>Resource Reallocation Priority Matrix</h2>
        <div class="legend-row">
          <span class="legend-item"><span class="legend-dot" style="background:#c0392b;"></span> Move to ARC (decline
            &gt; 30%)</span>
          <span class="legend-item"><span class="legend-dot" style="background:#f39c12;"></span> Monitor (decline &lt;
            30%)</span>
          <span class="legend-item"><span class="legend-dot" style="background:#27ae60;"></span> Invest More
            (growing)</span>
        </div>
        <div class="chart-wrap" style="height:380px;"><canvas id="chartMatrix"></canvas></div>
        <div class="insight"><strong>Recommendation:</strong> DVD, Juvenile, and Music collections have declined &gt;60%
          and are candidates for transfer to the Annex Research Center (ARC). Freed shelf space on Floors 5–6 should be
          repurposed for study rooms, tech checkout stations, and collaborative work areas. Equipment lending and the
          Secured Collection are growing rapidly and warrant increased investment.</div>
      </div>
    </div>

  </div>

  <script>
    /* Color palette */
    const maroon = '#501214';
    const gold = '#d4a843';
    const maroonLight = '#8c3a3d';
    const goldLight = '#e8c875';
    const gray = '#888';
    const blue = '#2c6fbb';
    const teal = '#1a8a7d';

    Chart.defaults.font.family = "'Segoe UI', Arial, sans-serif";
    Chart.defaults.font.size = 12;
    Chart.register(ChartDataLabels);
    Chart.defaults.plugins.datalabels = { display: false };

    /* Responsive font sizing */
    function getResponsiveFontSize() {
      if (window.innerWidth < 480) return 10;
      if (window.innerWidth < 768) return 11;
      return 12;
    }

    function updateChartFontSizes() {
      Chart.defaults.font.size = getResponsiveFontSize();
    }

    updateChartFontSizes();
    window.addEventListener('resize', updateChartFontSizes);

    /* Chart 1: Annual Circulation Bar */
    new Chart(document.getElementById('chart1'), {
      type: 'bar',
      data: {
        labels: ['FY14', 'FY15', 'FY16', 'FY17', 'FY18', 'FY19', 'FY20', 'FY21', 'FY22', 'FY23', 'FY24'],
        datasets: [{
          label: 'Annual Checkouts',
          data: [152664, 172909, 161701, 159229, 142201, 111846, 86065, 61659, 64315, 60726, 64090],
          backgroundColor: [maroon, maroon, maroon, maroon, maroon, maroon, '#a04244', '#c06062', '#c06062', maroonLight, maroonLight],
          borderRadius: 3
        }]
      },
      options: {
        responsive: true, maintainAspectRatio: false,
        plugins: {
          legend: { display: false },
          tooltip: { callbacks: { label: ctx => ctx.raw.toLocaleString() + ' checkouts' } }
        },
        scales: {
          y: { beginAtZero: true, ticks: { callback: v => (v / 1000) + 'K' }, title: { display: true, text: 'Total Checkouts' } },
          x: { grid: { display: false }, ticks: { maxRotation: 45, minRotation: 0 } }
        }
      }
    });

    /* UPGRADED: Dual-Axis Divergence Line Chart */
    (() => {
      const years = ['FY15', 'FY16', 'FY17', 'FY18', 'FY19', 'FY20', 'FY21', 'FY22', 'FY23', 'FY24'];
      const circ = [172909, 161701, 159229, 142201, 111846, 86065, 61659, 64315, 60726, 64090];
      const enroll = [null, null, null, null, null, 42292, null, null, 41676, 42138];

      new Chart(document.getElementById('chartDivergence'), {
        type: 'line',
        data: {
          labels: years,
          datasets: [
            {
              label: 'Annual Circulation',
              data: circ,
              borderColor: maroon,
              backgroundColor: maroon,
              pointRadius: window.innerWidth < 768 ? 3 : 5,
              pointStyle: 'circle',
              borderWidth: window.innerWidth < 768 ? 2 : 3,
              tension: 0.25,
              yAxisID: 'yCirc',
              fill: false
            },
            {
              label: 'Student Enrollment',
              data: enroll,
              borderColor: gold,
              backgroundColor: gold,
              pointRadius: window.innerWidth < 768 ? 4 : 7,
              pointStyle: 'rectRot',
              borderWidth: window.innerWidth < 768 ? 2 : 3,
              borderDash: [6, 4],
              tension: 0,
              yAxisID: 'yEnroll',
              spanGaps: false,
              fill: false
            }
          ]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          plugins: {
            legend: { position: 'bottom', labels: { boxWidth: 14, font: { size: getResponsiveFontSize() } } },
            tooltip: { callbacks: { label: ctx => ctx.dataset.label + ': ' + (ctx.raw ? ctx.raw.toLocaleString() : 'N/A') } }
          },
          scales: {
            yCirc: {
              type: 'linear', position: 'left',
              title: { display: window.innerWidth >= 768, text: 'Annual Circulation', color: maroon, font: { weight: 'bold', size: getResponsiveFontSize() } },
              ticks: { color: maroon, callback: v => (v / 1000) + 'K', font: { size: getResponsiveFontSize() } },
              grid: { color: 'rgba(80,18,20,0.08)' },
              min: 40000, max: 200000
            },
            yEnroll: {
              type: 'linear', position: 'right',
              title: { display: window.innerWidth >= 768, text: 'Student Enrollment', color: '#b8860b', font: { weight: 'bold', size: getResponsiveFontSize() } },
              ticks: { color: '#b8860b', callback: v => (v / 1000) + 'K', font: { size: getResponsiveFontSize() } },
              grid: { drawOnChartArea: false },
              min: 35000, max: 50000
            },
            x: { grid: { display: false }, ticks: { maxRotation: 45, minRotation: 0, font: { size: getResponsiveFontSize() } } }
          }
        }
      });
    })();

    /* Chart 3: By type stacked */
    new Chart(document.getElementById('chart3'), {
      type: 'bar',
      data: {
        labels: ['FY20', 'FY21', 'FY22', 'FY23', 'FY24'],
        datasets: [
          { label: 'Print/Media', data: [60516, 45702, 47984, 46103, 44715], backgroundColor: maroon },
          { label: 'Reserve', data: [8432, 2435, 3587, 3394, 1493], backgroundColor: goldLight },
          { label: 'Equipment/Keys', data: [7399, 8795, 7388, 8371, 14616], backgroundColor: teal },
          { label: 'Laptops/Computers', data: [9718, 4727, 5356, 2858, 3266], backgroundColor: blue }
        ]
      },
      options: {
        responsive: true, maintainAspectRatio: false,
        plugins: { legend: { position: 'bottom', labels: { boxWidth: 12, font: { size: getResponsiveFontSize() } } } },
        scales: {
          x: { stacked: true, grid: { display: false }, ticks: { font: { size: getResponsiveFontSize() } } },
          y: { stacked: true, ticks: { callback: v => (v / 1000) + 'K', font: { size: getResponsiveFontSize() } } }
        }
      }
    });

    /* Chart 4: Equipment share */
    const equipPct = [((7399 + 9718) / 86065 * 100).toFixed(1), ((8795 + 4727) / 61659 * 100).toFixed(1), ((7388 + 5356) / 64315 * 100).toFixed(1), ((8371 + 2858) / 60726 * 100).toFixed(1), ((14616 + 3266) / 64090 * 100).toFixed(1)];
    const printPct = [(60516 / 86065 * 100).toFixed(1), (45702 / 61659 * 100).toFixed(1), (47984 / 64315 * 100).toFixed(1), (46103 / 60726 * 100).toFixed(1), (44715 / 64090 * 100).toFixed(1)];
    new Chart(document.getElementById('chart4'), {
      type: 'line',
      data: {
        labels: ['FY20', 'FY21', 'FY22', 'FY23', 'FY24'],
        datasets: [
          { label: '% Print/Media', data: printPct, borderColor: maroon, backgroundColor: maroon, tension: 0.3, pointRadius: window.innerWidth < 768 ? 4 : 5, borderWidth: 2.5 },
          { label: '% Equipment + Laptops', data: equipPct, borderColor: teal, backgroundColor: teal, tension: 0.3, pointRadius: window.innerWidth < 768 ? 4 : 5, borderWidth: 2.5 }
        ]
      },
      options: {
        responsive: true, maintainAspectRatio: false,
        plugins: { legend: { position: 'bottom', labels: { boxWidth: 12, font: { size: getResponsiveFontSize() } } } },
        scales: {
          y: { min: 0, max: 85, ticks: { callback: v => v + '%', font: { size: getResponsiveFontSize() } }, title: { display: window.innerWidth >= 768, text: 'Share of Total Checkouts' } },
          x: { grid: { display: false }, ticks: { font: { size: getResponsiveFontSize() } } }
        }
      }
    });

    /* Chart 5: Patron pie FY2024 */
    new Chart(document.getElementById('chart5'), {
      type: 'doughnut',
      data: {
        labels: ['Undergraduate', 'Graduate', 'Faculty', 'Staff', 'Other (ILL, etc.)'],
        datasets: [{ data: [35383, 5246, 13127, 3109, 7078], backgroundColor: [maroon, maroonLight, gold, teal, gray] }]
      },
      options: {
        responsive: true, maintainAspectRatio: false,
        plugins: {
          datalabels: {
            display: window.innerWidth >= 480,
            color: '#fff', font: { weight: 'bold', size: getResponsiveFontSize() },
            formatter: (value) => ((value / 63943) * 100).toFixed(1) + '%'
          },
          legend: { position: 'bottom', labels: { boxWidth: 12, font: { size: getResponsiveFontSize() } } },
          tooltip: { callbacks: { label: ctx => ctx.label + ': ' + ctx.raw.toLocaleString() + ' (' + ((ctx.raw / 63943) * 100).toFixed(1) + '%)' } }
        }
      }
    });

    /* Chart 6: UG vs Grad */
    new Chart(document.getElementById('chart6'), {
      type: 'bar',
      data: {
        labels: ['FY20', 'FY21', 'FY22', 'FY23', 'FY24'],
        datasets: [
          { label: 'Undergraduate', data: [51397, 30257, 34257, 31533, 35383], backgroundColor: maroon, borderRadius: 3 },
          { label: 'Graduate', data: [8388, 7076, 7358, 5584, 5246], backgroundColor: gold, borderRadius: 3 }
        ]
      },
      options: {
        responsive: true, maintainAspectRatio: false,
        plugins: { legend: { position: 'bottom', labels: { boxWidth: 12, font: { size: getResponsiveFontSize() } } } },
        scales: {
          y: { beginAtZero: true, ticks: { callback: v => (v / 1000) + 'K', font: { size: getResponsiveFontSize() } } },
          x: { grid: { display: false }, ticks: { font: { size: getResponsiveFontSize() } } }
        }
      }
    });

    /* Chart 7: Top locations FY2024 */
    const locData = [
      ['General Collection', 33756], ['Secured Collection', 12601], ['Laptops', 3266],
      ['Juvenile Collection', 2940], ['Alkek One', 1941], ['Graphic Novels', 1778],
      ['Music Library', 1370], ['Ask Alkek/Reserve', 1333], ['DVD Shelves', 1300],
      ['Popular Reading', 802], ['Round Rock', 734], ['New Books', 680],
      ['Archives/Research', 639]
    ].sort((a, b) => b[1] - a[1]);

    new Chart(document.getElementById('chart7'), {
      type: 'bar',
      data: {
        labels: locData.map(d => d[0]),
        datasets: [{ label: 'FY2024 Checkouts', data: locData.map(d => d[1]), backgroundColor: locData.map((d, i) => i < 3 ? maroon : (i < 6 ? maroonLight : goldLight)), borderRadius: 3 }]
      },
      options: {
        indexAxis: 'y', responsive: true, maintainAspectRatio: false,
        plugins: { legend: { display: false }, tooltip: { callbacks: { label: ctx => ctx.raw.toLocaleString() + ' checkouts' } } },
        scales: {
          x: { ticks: { callback: v => (v / 1000) + 'K', font: { size: getResponsiveFontSize() } } },
          y: { grid: { display: false }, ticks: { font: { size: getResponsiveFontSize() } } }
        }
      }
    });

    /* PREDICTIVE: Circulation Forecast Line Chart */
    (() => {
      const labels = ['FY15', 'FY16', 'FY17', 'FY18', 'FY19', 'FY20', 'FY21', 'FY22', 'FY23', 'FY24', 'FY25', 'FY26'];
      const actual = [172909, 161701, 159229, 142201, 111846, 86065, 61659, 64315, 60726, 64090, null, null];
      const forecast = [null, null, null, null, null, null, 61659, 64315, 60726, 64090, 63624, 63994];

      new Chart(document.getElementById('chartForecast'), {
        type: 'line',
        data: {
          labels: labels,
          datasets: [
            {
              label: 'Actual Circulation',
              data: actual,
              borderColor: maroon,
              backgroundColor: maroon,
              pointRadius: window.innerWidth < 768 ? 3 : 5,
              pointStyle: 'circle',
              borderWidth: window.innerWidth < 768 ? 2 : 3,
              tension: 0.2,
              spanGaps: false,
              fill: false
            },
            {
              label: 'Forecast (Linear FY21–24)',
              data: forecast,
              borderColor: teal,
              backgroundColor: teal,
              pointRadius: window.innerWidth < 768 ? 4 : 6,
              pointStyle: 'triangle',
              borderWidth: window.innerWidth < 768 ? 2 : 3,
              borderDash: [8, 5],
              tension: 0,
              spanGaps: true,
              fill: false
            }
          ]
        },
        options: {
          responsive: true, maintainAspectRatio: false,
          plugins: {
            legend: { position: 'bottom', labels: { boxWidth: 14, font: { size: getResponsiveFontSize() } } },
            tooltip: { callbacks: { label: ctx => ctx.dataset.label + ': ' + (ctx.raw ? ctx.raw.toLocaleString() : '—') } },
            datalabels: {
              display: function (ctx) {
                return window.innerWidth >= 480 && ctx.datasetIndex === 1 && ctx.dataIndex >= 10;
              },
              color: teal,
              font: { weight: 'bold', size: getResponsiveFontSize() },
              anchor: 'end', align: 'top', offset: 4,
              formatter: v => v ? '~' + v.toLocaleString() : ''
            }
          },
          scales: {
            y: { beginAtZero: false, min: 40000, ticks: { callback: v => (v / 1000) + 'K', font: { size: getResponsiveFontSize() } }, title: { display: window.innerWidth >= 768, text: 'Annual Checkouts' } },
            x: { grid: { display: false }, ticks: { maxRotation: 45, minRotation: 0, font: { size: getResponsiveFontSize() } } }
          }
        }
      });
    })();

    /* PRESCRIPTIVE: Reallocation Matrix Horizontal Bar */
    (() => {
      const items = [
        { name: 'DVD Shelves', pct: -84.7, current: 1300 },
        { name: 'Music Library', pct: -66.9, current: 1370 },
        { name: 'Juvenile', pct: -62.9, current: 2940 },
        { name: 'General Collection', pct: -29.2, current: 33756 },
        { name: 'Graphic Novels', pct: -28.7, current: 1778 },
        { name: 'Game Shelves', pct: -25.2, current: 113 },
        { name: 'Laptops', pct: 14.3, current: 3266 },
        { name: 'Equipment/Keys', pct: 66.2, current: 14616 },
        { name: 'Secured Collection', pct: 67.0, current: 12601 }
      ];

      const colors = items.map(d => d.pct < -30 ? '#c0392b' : (d.pct < 0 ? '#f39c12' : '#27ae60'));

      new Chart(document.getElementById('chartMatrix'), {
        type: 'bar',
        data: {
          labels: items.map(d => d.name),
          datasets: [{
            label: '% Change',
            data: items.map(d => d.pct),
            backgroundColor: colors,
            borderRadius: 3,
            barThickness: window.innerWidth < 768 ? 18 : 22
          }]
        },
        options: {
          indexAxis: 'y',
          responsive: true, maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                label: ctx => {
                  const item = items[ctx.dataIndex];
                  return `${ctx.raw > 0 ? '+' : ''}${ctx.raw.toFixed(1)}%  (${item.current.toLocaleString()} loans FY24)`;
                }
              }
            },
            datalabels: {
              display: window.innerWidth >= 480,
              font: { weight: 'bold', size: getResponsiveFontSize() },
              color: function (ctx) {
                return ctx.dataset.data[ctx.dataIndex] < -30 ? '#fff' : (ctx.dataset.data[ctx.dataIndex] >= 0 ? '#27ae60' : '#f39c12');
              },
              anchor: function (ctx) {
                return ctx.dataset.data[ctx.dataIndex] < 0 ? 'start' : 'end';
              },
              align: function (ctx) {
                return ctx.dataset.data[ctx.dataIndex] < 0 ? 'start' : 'end';
              },
              offset: 4,
              formatter: v => (v > 0 ? '+' : '') + v.toFixed(0) + '%'
            }
          },
          scales: {
            x: {
              title: { display: window.innerWidth >= 768, text: '% Change (FY17→24 or FY21→24)', font: { size: getResponsiveFontSize() } },
              grid: { color: ctx => ctx.tick.value === 0 ? '#333' : 'rgba(0,0,0,0.06)' },
              ticks: { font: { size: getResponsiveFontSize() } }
            },
            y: { grid: { display: false }, ticks: { font: { size: getResponsiveFontSize() } } }
          }
        }
      });
    })();
  </script>
</body>

</html>